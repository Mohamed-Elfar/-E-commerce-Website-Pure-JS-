import{loginUser as e,validateName as t,validatePhone as n,validateEmail as s}from"/assets/js/utils.js";const a={sidebar:{container:document.getElementById("sidebarContainer"),sidebar:document.getElementById("sidebar"),openBtn:document.getElementById("openSidebar"),closeBtn:document.getElementById("closeSidebar")},mainContent:document.getElementById("mainContent"),userDisplay:{name:document.getElementById("userName"),revenue:document.querySelector(".TotalRevenue"),revenueRate:document.querySelector(".TotalRevenueRate"),inStock:document.querySelector(".inStock"),orders:document.querySelector(".totalOrders"),products:document.querySelector(".topSellingProducts"),totalProductsNum:document.querySelector(".totalProductsNum"),users:document.querySelector(".totalUsers"),flashTable:document.querySelector("table > tbody"),allProducts:document.querySelector(".allProducts")}};let o=JSON.parse(localStorage.getItem("users"))||[];const l=o.filter((e=>"Seller"===e.role));let r=JSON.parse(localStorage.getItem("allProducts"))||[];function d(){!function(){const{container:e,openBtn:t,closeBtn:n}=a.sidebar;e.classList.contains("collapsed")?(t.style.display="block",n.style.display="none",a.mainContent.classList.add("full")):(t.style.display="none",n.style.display="block",a.mainContent.classList.remove("full"));a.sidebar.openBtn.addEventListener("click",(()=>i(!1))),a.sidebar.closeBtn.addEventListener("click",(()=>i(!0)))}(),document.querySelectorAll(".section-toggle-btn").forEach((e=>{e.addEventListener("click",(function(){const e=this.getAttribute("data-show");for(let e of document.querySelectorAll(".section-toggle-btn"))e.classList.remove("active");this.classList.add("active"),Array.from(a.mainContent.children).forEach((e=>{e.classList.add("d-none"),e.classList.remove("active")})),document.getElementById(e)?.classList.remove("d-none")}))})),c(),function(){const e=document.getElementById("categoryChart").getContext("2d");new Chart(e,{type:"doughnut",data:{labels:["Men & Fashion","Electronics","Home & Lifestyle","Medicine","Sports & Outdoor"],datasets:[{data:[0,100,0,0,0],backgroundColor:["#3498db","#2ecc71","#9b59b6","#f1c40f","#e74c3c"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:e=>`${e.label}: ${e.raw}%`}}}}});const t=Array(7).fill(0);o?.forEach((e=>{e?.orders?.forEach((e=>{const n=new Date(e.date).getDay();t[n>6?0:n]+=Number(e.total)||0}))}));const n=document.getElementById("salesChart").getContext("2d");new Chart(n,{type:"line",data:{labels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],datasets:[{label:"Sales",data:t,backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:2,tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>`$${e}`}}}}})}(),function(){const e={hours:document.getElementById("flashSaleHours"),minutes:document.getElementById("flashSaleMinutes"),seconds:document.getElementById("flashSaleSeconds")};let t={h:parseInt(e.hours.textContent),m:parseInt(e.minutes.textContent),s:parseInt(e.seconds.textContent)};setInterval((()=>{t.s--,t.s<0&&(t.s=59,t.m--,t.m<0&&(t.m=59,t.h--)),e.hours.textContent=t.h.toString().padStart(2,"0"),e.minutes.textContent=t.m.toString().padStart(2,"0"),e.seconds.textContent=t.s.toString().padStart(2,"0")}),1e3)}(),u(),p()}function i(e){const{container:t,openBtn:n,closeBtn:s}=a.sidebar;t.classList.toggle("collapsed",e),a.mainContent.classList.toggle("full",e),n.style.display=e?"block":"none",s.style.display=e?"none":"block"}function c(){const t=e();a.userDisplay.name.textContent=`${t?.firstName} ${t?.lastName}`;let n=0,s=0;o.forEach((e=>{e?.orders?.forEach((e=>{s++,n+=Number(e.total)||0}))})),a.userDisplay.revenue.textContent=`$${n.toFixed(2)}`,a.userDisplay.orders.textContent=s;const l=parseFloat(localStorage.getItem("totalRevenuePrevDay"))||0;let d=0;l&&(d=0===l?0:(n-l)/l*100,Math.abs(d)<.001&&(d=0)),a.userDisplay.revenueRate.classList.add(d>=0?"text-success":"text-danger"),a.userDisplay.revenueRate.innerHTML=d>=0?`<i class="fas fa-arrow-up" aria-hidden="true"></i> ${Math.abs(d).toFixed(2)}% from last day`:`<i class="fas fa-arrow-down" aria-hidden="true"></i> ${Math.abs(d).toFixed(2)}% from last day`;const i=r.filter((e=>e.quantity>0)).length;a.userDisplay.totalProductsNum.textContent=r.length;const c=r.length-i;c>0?(a.userDisplay.inStock.classList.remove("d-none"),a.userDisplay.inStock.innerHTML=`<i class="fas fa-arrow-down" aria-hidden="true"></i> ${c} items low stock`):a.userDisplay.inStock.classList.add("d-none");const u=o?.length>0?o?.length-1:0;a.userDisplay.users.textContent=u,function(){const e={};o?.forEach((t=>{t?.orders?.forEach((t=>{t.products?.forEach((t=>{e[t.id]||(e[t.id]={...t,count:0}),e[t.id].count+=t.count||0}))}))}));const t=Object.values(e).sort(((e,t)=>t.count-e.count)).slice(0,4);a.userDisplay.products.innerHTML=t.map((e=>`\n    <div class="col-sm-6 col-md-6 col-lg-6 mb-3">\n      <div class="card product-card h-100">\n        <img src="${e.image}" class="card-img-top w-50" alt="Product" loading ="lazy"/>\n        ${e.sale.trim()?`<span class="discount-badge">${e.sale} OFF</span>`:""}\n        <div class="card-body">\n          <h6 class="card-title">${e.name}</h6>\n          <div class="d-flex justify-content-between align-items-center">\n            <div>\n              <span class="text-danger"> $${e.sale.trim()?parseFloat(e.price)*(1-parseFloat(e.sale)/100):e.price}</span>\n              ${e.sale.trim()?`\n                <span class="text-muted text-decoration-line-through ms-2">\n                  $${e.price}\n                </span>\n              `:""}\n            </div>\n            <span class="text-muted small">${e.count} sold</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  `)).join("")}(),function(){const e={};o?.forEach((t=>{t?.orders?.forEach((t=>{t.products?.forEach((t=>{e[t.id]?e[t.id]+=t.count||0:e[t.id]=t.count||0}))}))}));const t=r.filter((e=>e.sale)).sort(((e,t)=>parseFloat(t.sale)-parseFloat(e.sale)));a.userDisplay.flashTable.innerHTML=t.map((t=>`\n    <tr>\n      <td>${t.name}</td>\n      <td>\n        <span class="badge ${parseFloat(t.sale)>15?"bg-danger bg-opacity-10 text-danger":"bg-success bg-opacity-10 text-success"}">\n          ${t.sale}\n        </span>\n      </td>\n      <td>${e[t.id]||0}</td>\n      <td>$${t.price}</td>\n    </tr>\n  `)).join("")}()}function u(){const e=document.getElementById("usersAccordion");e.innerHTML="",o?.slice(1).forEach((t=>{const n=t?.userId,s="Seller"===t?.role?"role-seller":"role-customer";e.innerHTML+=`\n      <div class="accordion-item mb-2">\n        <h2 class="accordion-header" id="heading-${n}">\n          <button class="accordion-button" type="button" data-bs-toggle="collapse" \n            data-bs-target="#collapse-${n}" aria-expanded="false" aria-controls="collapse-${n}">\n            ${t?.firstName} ${t?.lastName}\n            <span class="user-role ${s}">${t?.role}</span>\n          </button>\n        </h2>\n        <div id="collapse-${n}" class="accordion-collapse collapse" \n          aria-labelledby="heading-${n}" data-bs-parent="#usersAccordion">\n          <div class="accordion-body">\n            <div class="user-info-item">\n              <span class="user-info-label">First Name:</span> ${t?.firstName}\n            </div>\n            <div class="user-info-item">\n              <span class="user-info-label">Last Name:</span> ${t?.lastName}\n            </div>\n            <div class="user-info-item">\n              <span class="user-info-label">Email:</span> ${t?.email}\n            </div>\n            <div class="user-info-item">\n              <span class="user-info-label">Phone:</span> ${t?.phone}\n            </div>\n            <div class="user-info-item">\n              <span class="user-info-label">Role:</span> ${t?.role}\n            </div>\n            <div class="mt-3">\n              <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-${n}">\n                <i class="fas fa-edit me-1" aria-hidden="true"></i> Edit\n              </button>\n              <button class="btn btn-danger ms-2" onclick="window.deleteUser(${n})">\n                <i class="fas fa-trash-alt me-1" aria-hidden="true"></i> Delete\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- User Modal --\x3e\n      <div class="modal fade" id="modal-${n}" tabindex="-1" aria-hidden="true">\n        <div class="modal-dialog">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title">Edit User</h5>\n              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n            </div>\n            <div class="modal-body">\n              <form onsubmit="window.saveUserChanges(${n}); return false;">\n                <div class="mb-3">\n                  <label class="form-label">First Name</label>\n                  <input type="text" class="form-control" id="modal-${n}-firstName" \n                    value="${t?.firstName}" required>\n                </div>\n                <div class="mb-3">\n                  <label class="form-label">Last Name</label>\n                  <input type="text" class="form-control" id="modal-${n}-lastName" \n                    value="${t?.lastName}" required>\n                </div>\n                <div class="mb-3">\n                  <label class="form-label">Email</label>\n                  <input type="email" class="form-control" id="modal-${n}-email" \n                    value="${t?.email}" required>\n                </div>\n                <div class="mb-3">\n                  <label class="form-label">Phone</label>\n                  <input type="tel" class="form-control" id="modal-${n}-phone" \n                    value="${t?.phone}" required>\n                </div>\n                <div class="mb-3">\n                  <label class="form-label">Role</label>\n                  <select class="form-select" id="modal-${n}-role" required>\n                    <option value="Customer" ${"Customer"===t?.role?"selected":""}>Customer</option>\n                    <option value="Seller" ${"Seller"===t?.role?"selected":""}>Seller</option>\n                  </select>\n                </div>\n                <div class="modal-footer">\n                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>\n                  <button type="submit" class="btn btn-primary">Save</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    `})),m()}function m(){const e=document.querySelector(".applications"),t=document.querySelector(".pending"),n=document.querySelector(".noPending"),s=o?.filter((e=>e?.want_to_be_seller));if(t.textContent=`${s.length} pending`,0===s.length)return n.classList.remove("d-none"),void(e.innerHTML="");n.classList.add("d-none"),e.innerHTML=s.map((e=>`\n    <div class="request-item">\n      <div class="request-username">${e?.firstName} ${e?.lastName}</div>\n      <div class="request-email">${e?.email}</div>\n      <div class="mt-2">\n        <button class="btn btn-success btn-accept" onclick="window.approveSeller(${e?.userId})">\n          <i class="fas fa-check me-1" aria-hidden="true"></i> Approve\n        </button>\n        <button class="btn btn-danger btn-reject" onclick="window.rejectSeller(${e?.userId})">\n          <i class="fas fa-times me-1" aria-hidden="true"></i> Reject\n        </button>\n      </div>\n    </div>\n  `)).join("")}function p(){document.querySelector(".totalProductsHeader").innerHTML=` (${r.length})`,a.userDisplay.allProducts.innerHTML="",r.forEach((e=>{const t=e.images.map(((t,n)=>`\n        <button type="button" data-bs-target="#carousel-${e.id}" \n                data-bs-slide-to="${n}" \n                ${0===n?'class="active" aria-current="true"':""}\n                aria-label="Slide ${n+1}"></button>\n      `)).join(""),n=e.images.map(((t,n)=>`\n        <div class="carousel-item ${0===n?"active":""}">\n          <img src="${t}" \n               class="d-block product-img" \n               style="width: 250px; height: 200px; object-fit: contain;"\n               alt="${e.name}"\n               loading ="lazy">\n        </div>\n      `)).join("");a.userDisplay.allProducts.innerHTML+=`\n      <div class="col-lg-4 col-md-6 mb-4">\n        <div class="card h-100">\n          <div id="carousel-${e.id}" class="carousel slide" data-bs-ride="carousel">\n            <div class="carousel-indicators">\n              ${t}\n            </div>\n            <div class="carousel-inner text-center">\n              ${n}\n            </div>\n            ${e.images.length>1?`\n            <button class="carousel-control-prev" type="button" \n                    data-bs-target="#carousel-${e.id}" data-bs-slide="prev">\n              <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n              <span class="visually-hidden">Previous</span>\n            </button>\n            <button class="carousel-control-next" type="button" \n                    data-bs-target="#carousel-${e.id}" data-bs-slide="next">\n              <span class="carousel-control-next-icon" aria-hidden="true"></span>\n              <span class="visually-hidden">Next</span>\n            </button>\n            `:""}\n          </div>\n          <div class="product-card-body">\n            <h5 class="product-name">${e.name}</h5>\n            <span class="product-price mb-2">$${e.price.toFixed(2)}</span>\n            <div class="product-meta mb-2">\n              <div>\n                <i class="fas fa-tag" aria-hidden="true"></i>\n                <span class="category-badge">${e.category}</span>\n              </div>\n              <div><i class="fas fa-user" aria-hidden="true"></i> ${e.seller||"Admin"}</div>         \n              ${e.sale?`<div><i class="fas fa-percent" aria-hidden="true"></i> ${e.sale}</div>`:'<div><i class="fas fa-percent" aria-hidden="true"></i> no sale</div>'}\n              <div class="product-quantity mb-2">\n                <i class="fas fa-boxes" aria-hidden="true"></i> Quantity: ${e.quantity||0}\n              </div>\n            </div>\n            <div class="d-flex justify-content-around mt-3">\n              <button class="btn btn-primary px-4 edit-btn" data-product-id="${e.id}">\n                <i class="fas fa-edit me-1" aria-hidden="true"></i> Edit\n              </button>\n              <button class="btn btn-danger px-4 delete-btn" data-product-id="${e.id}">\n                <i class="fas fa-trash-alt me-1" aria-hidden="true"></i> Delete\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `})),document.querySelectorAll(".carousel").forEach((e=>{new bootstrap.Carousel(e)})),function(){a.userDisplay.allProducts.addEventListener("click",(function(e){const t=e.target.closest(".edit-btn"),n=e.target.closest(".delete-btn");if(t){const e=parseInt(t.dataset.productId),n=r.find((t=>t.id===e));if(n){!function(e){document.querySelector(".product-id").value=e.id,document.querySelector(".productNameEdit").value=e.name,document.querySelector(".productPriceEdit").value=e.price,document.querySelector(".product-description").value=e.description||"",document.querySelector(".productSaleEdit").value=parseFloat(e.sale)||0,document.querySelector(".productQuantityEdit").value=Number(e.quantity)||0;const t=document.querySelector(".product-category");if(t)for(let n=0;n<t.options.length;n++)if(t.options[n].value===e.category){t.selectedIndex=n;break}const n=document.querySelector(".product-seller");if(n.innerHTML='<option value="">Select Seller</option>',n.innerHTML+=l.map((e=>`                        \n      <option value="${e.userId}">${e.firstName}</option>`)).join(""),n)for(let t=0;t<n.options.length;t++)if(n.options[t].text===e.seller){n.selectedIndex=t;break}const s=document.querySelector(".add-modal__img");s&&e.image&&(s.src=e.image)}(n);new bootstrap.Modal(document.getElementById("productEditModal")).show()}}if(n){!async function(e){(await Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed&&(r=r.filter((t=>t.id!==e)),localStorage.setItem("allProducts",JSON.stringify(r)),p(),c(),await Swal.fire("Deleted!","Product has been deleted.","success"))}(parseInt(n.dataset.productId))}}));const e=document.querySelector(".product-edit-form");e&&e.addEventListener("submit",(function(e){e.preventDefault(),async function(){const e=parseInt(document.querySelector(".product-id").value),t=r.findIndex((t=>t.id===e));if(-1!==t){const e={...r[t],name:document.querySelector(".productNameEdit").value,price:parseFloat(document.querySelector(".productPriceEdit").value),category:document.querySelector(".product-category").value,seller:document.querySelector(".product-seller").options[document.querySelector(".product-seller").selectedIndex].text,createdBy:document.querySelector(".product-seller").value,description:document.querySelector(".product-description").value,sale:parseInt(document.querySelector(".productSaleEdit").value)+"%"||"",quantity:parseInt(document.querySelector(".productQuantityEdit").value)||0},n=document.querySelector(".product-image");n.files.length>0&&(e.image=URL.createObjectURL(n.files[0]),e.images=[e.image]),r[t]=e,localStorage.setItem("allProducts",JSON.stringify(r)),p(),c();bootstrap.Modal.getInstance(document.getElementById("productEditModal")).hide(),await Swal.fire("Success!","Product updated successfully!","success")}}()}))}()}window.saveUserChanges=async function(e){try{const a=bootstrap.Modal.getInstance(document.getElementById(`modal-${e}`)),l={firstName:document.getElementById(`modal-${e}-firstName`).value.trim(),lastName:document.getElementById(`modal-${e}-lastName`).value.trim(),email:document.getElementById(`modal-${e}-email`).value.trim(),phone:document.getElementById(`modal-${e}-phone`).value.trim(),role:document.getElementById(`modal-${e}-role`).value};if(!t(l?.firstName)||!t(l.lastName))throw new Error("Please enter valid names");if(!s(l?.email))throw new Error("Please enter a valid email");if(!n(l?.phone))throw new Error("Please enter a valid phone number");const r=o?.findIndex((t=>t.userId===e));if(-1===r)throw new Error("User not found");o[r]={...o[r],...l},localStorage.setItem("users",JSON.stringify(o)),await Swal.fire("Success!","User updated successfully","success"),a.hide(),u()}catch(e){await Swal.fire("Error!",e.message,"error")}},window.deleteUser=async function(e){(await Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed&&(o=o?.filter((t=>t.userId!==e)),localStorage.setItem("users",JSON.stringify(o)),await(Swal?.fire("Deleted!","User has been deleted.","success")),u())},window.approveSeller=async function(e){const t=o?.findIndex((t=>t.userId===e));-1!==t&&(o[t]={...o[t],role:"Seller",want_to_be_seller:!1},localStorage.setItem("users",JSON.stringify(o)),await(Swal?.fire("Approved!","User is now a seller.","success")),m(),u())},window.rejectSeller=async function(e){const t=o.findIndex((t=>t.userId===e));-1!==t&&(o[t]={...o[t],want_to_be_seller:!1},localStorage.setItem("users",JSON.stringify(o)),await(Swal?.fire("Rejected!","Seller request rejected.","success")),m())},document.getElementById("productSaveBtn").addEventListener("click",(function(){document.querySelector(".product-edit-form").dispatchEvent(new Event("submit"))}));const g=document.getElementById("productImage");g&&g.addEventListener("change",(function(){const e=document.getElementById("addProductImagePreview");e&&(e.src=v("productImage"))}));const f=document.querySelector(".product-image");function v(e){const t=document.getElementById(e);return t.files&&t.files[0]?URL.createObjectURL(t.files[0]):null}f&&f.addEventListener("change",(function(){const e=document.querySelector(".add-modal__img");e&&(e.src=v("productImage"))}));const b=document.getElementById("addProductForm");if(b){const e=document.getElementById("productSeller");e.innerHTML='<option value="">Select Seller</option>',e.innerHTML+=l.map((e=>`                        \n      <option value="${e.userId}">${e.firstName}</option>`)).join(""),b.addEventListener("submit",(async function(e){e.preventDefault();const t={id:r.length>0?Math.max(...r.map((e=>e.id)))+1:1,name:document.getElementById("productName").value,price:parseFloat(document.getElementById("productPrice").value),category:document.getElementById("productCategory").value,seller:document.getElementById("productSeller").options[document.getElementById("productSeller").selectedIndex].text,createdBy:document.getElementById("productSeller").value,description:document.getElementById("productDescription").value,image:v("productImage")||"/assets/images/products/default-product.jpg",images:[v("productImage")]||["/assets/images/products/default-product.jpg"],quantity:10,rating:0,ratingCount:0,reviews:[],sale:""+(""!==document.querySelector(".product-sale").value.trim()?document.querySelector(".product-sale").value+"%":"")};r.push(t),localStorage.setItem("allProducts",JSON.stringify(r)),p(),c(),b.reset();bootstrap.Modal.getInstance(document.getElementById("addProductModal")).hide(),await Swal.fire("Success!","Product added successfully!","success")}))}const y={elements:{container:document.getElementById("messagesContainer"),usersContainer:document.getElementById("users-container"),noMessage:document.getElementById("noMessage"),filterButtons:document.querySelectorAll(".filter-buttons button"),modalUserName:document.getElementById("modalUserName"),modalMessagesContainer:document.getElementById("modal-messages-container")},init(){this.elements.container?.classList.remove("d-none");const e=JSON.parse(localStorage.getItem("contact"))||[],t=this.groupMessagesByUser(e);this.renderUserCards(t),this.setupEventListeners(t),this.filterMessages("all",t)},groupMessagesByUser:e=>e.reduce(((e,t,n)=>{const{email:s}=t;return e[s]||(e[s]={name:t.name,email:s,phone:t.phone,role:t.role||"Customer",unread:!0,messages:[]}),e[s].messages.push({...t,id:n}),e}),{}),renderUserCards(e){const{usersContainer:t,noMessage:n}=this.elements,s=Object.keys(e).length>0;n.classList.toggle("d-none",s),s&&(t.innerHTML=Object.entries(e).map((([e,t],n)=>this.createUserCard(t,n))).join(""))},createUserCard(e,t){const n="Seller"===e.role?"badge-seller":"badge-customer";return`\n      <div class="col-md-6 col-lg-4 user-card-container"\n           data-role="${e.role}"\n           data-unread="${e.unread}"\n           data-user-id="${t}">\n        <div class="user-card h-100">\n          <div class="user-header">\n            <h3 class="user-name">${e.name}</h3>\n            <span class="badge badge-role ${n}">\n              ${e.role}\n            </span>\n          </div>\n          <div class="user-body d-flex align-items-center justify-content-between mt-2 py-4">\n            <div>\n              <div class="user-detail">\n                <i class="fas fa-envelope"></i>\n                <span>${e.email}</span>\n              </div>\n              <div class="user-detail">\n                <i class="fas fa-phone"></i>\n                <span>${e.phone}</span>\n              </div>\n            </div>\n            <div>\n              <button class="messages-btn"\n                      data-bs-toggle="modal"\n                      data-bs-target="#messagesModal"\n                      data-user-id="${t}">\n                <i class="fas fa-comments"></i>\n                <span class="messages-count">${e.messages.length}</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `},setupEventListeners(e){const{filterButtons:t}=this.elements;t.forEach((t=>{t.addEventListener("click",(()=>{const n=t.id.replace("filter","").toLowerCase();this.filterMessages(n,e)}))})),document.addEventListener("click",(t=>{const n=t.target.closest(".messages-btn");n&&this.openUserMessages(n.dataset.userId,e)}))},filterMessages(e,t){const{noMessage:n}=this.elements,s=document.querySelectorAll(".user-card-container");let a=!1;s.forEach((t=>{const n="all"===e||"customers"===e&&"Customer"===t.dataset.role||"sellers"===e&&"Seller"===t.dataset.role||"unread"===e&&"true"===t.dataset.unread;t.style.display=n?"":"none",n&&(a=!0)})),n.classList.toggle("d-none",a)},openUserMessages(e,t){const{modalUserName:n,modalMessagesContainer:s}=this.elements,a=Object.values(t)[e];if(!a)return;n.textContent=a.name,s.innerHTML=a.messages.map((e=>`\n        <div class="modal-message">\n          <p>${e.message}</p>\n          <div class="message-date">${e.date}</div>\n        </div>\n      `)).join(""),a.unread=!1;const o=document.querySelector(`.user-card-container[data-user-id="${e}"]`);o&&(o.dataset.unread="false")}};document.querySelector("[data-show=messagesContainer]").addEventListener("click",(()=>y.init())),document.addEventListener("DOMContentLoaded",(()=>{d()}));