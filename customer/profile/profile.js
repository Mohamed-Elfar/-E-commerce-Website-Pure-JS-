import{showToast as e,validateName as t,validateEmail as n,validatePhone as o,validatePasswordMatch as s,validatePassword as a,hashPassword as r,validateHashedPassword as l}from"/assets/js/utils.js";!function(){const e=getUserByToken(localStorage.getItem("token"));e?(document.getElementById("username").innerHTML=e.firstName,document.getElementById("firstName").value=e.firstName,document.getElementById("lastName").value=e.lastName,document.getElementById("email").value=e.email,document.getElementById("phonenumber").value=e.phone):document.getElementById("username").innerHTML="Guest"}(),document.querySelector("#saveChanges").addEventListener("click",(function(l){if(l.preventDefault(),function(){const e=t(document.getElementById("firstName")),l=t(document.getElementById("lastName")),m=n(document.getElementById("email")),d=o(document.getElementById("phonenumber")),u=function(e){const t=localStorage.getItem("users"),n=JSON.parse(t);return n.find((t=>t.password===e))?(document.getElementById("currentpassword").classList.remove("is-invalid"),document.getElementById("currentpassword").classList.add("is-valid"),!0):(document.getElementById("currentpassword").classList.add("is-invalid"),document.getElementById("currentpassword").classList.remove("is-valid"),!1)}(r(document.getElementById("currentpassword").value)),c=a(document.getElementById("newpassword")),i=s(document.getElementById("newpassword"),document.getElementById("confirmpassword"));return e&&l&&m&&d&&c&&i&&u}()){const t=localStorage.getItem("token");if(!getUserByToken(t))return void e("error","User not found");const n=localStorage.getItem("users");!function(e){Swal.fire({title:"Are you sure?",text:"Your settings will be updated. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, update!",cancelButtonText:"Cancel",reverseButtons:!0,background:"#fff",color:"#333"}).then((t=>{t.isConfirmed?(localStorage.setItem("users",JSON.stringify(e)),Swal.fire({title:"Updated!",text:"Your changes have been saved successfully.",icon:"success",confirmButtonText:"OK",confirmButtonColor:"#27ae60"}).then((()=>{window.location.href="../home/home.html"}))):t.dismiss===Swal.DismissReason.cancel&&Swal.fire({title:"Cancelled",text:"No changes were made.",icon:"info",confirmButtonText:"OK",confirmButtonColor:"#3498db"})}))}(JSON.parse(n).map((e=>e.token===t?{...e,firstName:document.getElementById("firstName").value,lastName:document.getElementById("lastName").value,email:document.getElementById("email").value,phone:document.getElementById("phonenumber").value,password:r(document.getElementById("newpassword").value)}:e)))}}));export function getUserByToken(e){const t=localStorage.getItem("users");if(!t)return null;return JSON.parse(t).find((t=>t.token===e))||null}