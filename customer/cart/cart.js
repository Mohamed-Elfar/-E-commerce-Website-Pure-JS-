import{showToast as e,updateBadges as t}from"/assets/js/utils.js";document.querySelector(".button--return").addEventListener("click",(()=>{window.location.href="../home/home.html"}));const n=document.querySelector("tbody"),c=document.getElementById("subtotalincart"),o=document.getElementById("shipping"),r=document.getElementById("Total"),s=document.getElementById("coupon"),l=document.querySelector(".button--coupon"),i=document.querySelector(".button--clear");let a=0,d=30;const u=[];function m(){const c=JSON.parse(localStorage.getItem("cart"))||[];c.forEach((o=>{const r=o.quantity;if(o){const s=document.createElement("tr");s.innerHTML=`\n          <td>\n            <div class="d-flex align-items-center gap-2">\n                <img src="${o.image}" width="50" alt="${o.name}">\n                <p class="mb-0">${o.name}</p>\n            </div>\n          </td>\n          <td class="price"><div class="d-flex align-items-center" style="height:50px"> $${o.price}</div></td>\n          <td><div class="d-flex align-items-center" style="height:50px"> <input type="number" class="quantity form-control" min="1" max="${r}" value="${o.count}"> </div></td>\n          <td class="subtotal"><div class="d-flex align-items-center" style="height:50px"> $${o.price}</div> </td>\n          <td><button class="btn btn-sm border-0 delete-btn">X</button></td>\n        `,n.appendChild(s);const l=s.querySelector(".quantity"),i=s.querySelector(".subtotal"),a=s.querySelector(".delete-btn"),d=o.price;if(u.push({quantityInput:l,subtotalCell:i,price:d,row:s}),0!=u.length){document.querySelector(".button--process").addEventListener("click",(()=>{e("success","Order placed successfully"),location.href="/customer/checkout/checkout.html"}))}l.addEventListener("input",(()=>{const e=parseInt(l.value)||1;i.innerHTML=`<div class="d-flex align-items-center" style="height:50px"> $${(e*d).toFixed(2)} </div>`,o.count=e,localStorage.setItem("cart",JSON.stringify(c)),p()})),a.addEventListener("click",(()=>{s.remove();const n=u.findIndex((e=>e.quantityInput===l));-1!==n&&(u.splice(n,1),c.splice(n,1)),localStorage.setItem("cart",JSON.stringify(c)),t(),p(),e("info","Product removed from cart")}))}}))}function p(){let e=0;u.forEach((t=>{const n=parseInt(t.quantityInput.value)||1;e+=n*t.price}));const t=e*(1-a);c.innerText=`$${e.toFixed(2)}`,o.innerText=`$${d}`,r.innerText=`$${(t+d).toFixed(2)}`}function g(e){const t=localStorage.getItem("cart"),n=(t?JSON.parse(t):[]).map((t=>({...t,discount:e})));localStorage.setItem("cart",JSON.stringify(n))}m(),l.addEventListener("click",(()=>{"Group6-30"===s.value.trim()?(a=.3,s.style.border="3px solid green",g(a),e("success","Coupon applied successfully")):(a=0,s.style.border="3px solid red",g(a),e("warning","Invalid coupon code")),p()})),i.addEventListener("click",(()=>{n.innerHTML="",u.length=0,localStorage.removeItem("cart"),p(),m(),e("success","Cart cleared successfully"),t()})),p();