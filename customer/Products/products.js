import{addToCart as e,search as t,toggleWishList as a,loginUser as c}from"../../assets/js/utils.js";function n(){const e=parseFloat(document.getElementById("minPrice").value)||0,t=parseFloat(document.getElementById("maxPrice").value)||1/0,a=document.querySelectorAll('.filter-options input[type="checkbox"]'),c=Array.from(a).filter((e=>e.checked)).map((e=>e.value));document.querySelectorAll("#product-container .col-md-4").forEach((a=>{const n=a.querySelector(".product__category")?.dataset.category,o=a.querySelector(".product__price-new")?.textContent.replace("$","")||"0",r=parseFloat(o),d=r>=e&&r<=t,i=0===c.length||c.includes(n);a.style.display=d&&i?"block":"none"}))}fetch("../../assets/data/products.json").then((e=>e.json())).then((t=>{localStorage.getItem("allProducts")||localStorage.setItem("allProducts",JSON.stringify(t));const o=document.getElementById("product-container"),r=JSON.parse(localStorage.getItem("wishlist"))||[],d=c();t.forEach((t=>{const c=document.createElement("div");c.classList.add("col-md-4");const n=r.includes(t.id.toString());let i="";"Smartphones"===t.category?i='<i class="fa-solid fa-mobile-screen-button"></i>':"Laptops"===t.category?i='<i class="fa-solid fa-laptop"></i>':"Headphones"===t.category?i='<i class="fa-solid fa-headphones"></i>':"Tablets"===t.category?i='<i class="fa-solid fa-tablet-screen-button"></i>':"Smartwatches"===t.category?i='<i class="fa-solid fa-clock"></i>':"Gaming"===t.category&&(i='<i class="fa-solid fa-gamepad"></i>'),c.innerHTML=`\n        <div class="product bg-light">\n          <div class="product__badge">\n            <div class="product__actions">\n              <div class="product__discount" style="${t.sale?"":"visibility: hidden"}">${t.sale}</div>\n              <div class="product__icons">\n                <a  class="border-0" ${d?.userId===parseInt(t.createdBy)||"Admin"===d?.role?"disabled":""}>\n                  <div class="product__icon-container">\n                    <i class="product__icon fa-heart ${n?"active fa-solid":"fa-regular"}" aria-hidden="true"></i>\n                  </div>\n                </a>\n                <a href="/customer/product-details/product-details.html?id=${t.id}" class="border-0">\n                  <div class="product__icon-container">\n                    <i class="product__icon fa-regular fa-eye" aria-hidden="true"></i>\n                  </div>\n                </a>\n              </div>\n            </div>\n            <img class="product__image" src="${t.image}" alt="${t.name}" loading="lazy">\n            <a href="#"><div class="product__overlay">Add To Cart</div></a>\n          </div>\n          <div>\n            <div class="d-flex">\n              <p class="product__title">${t.name.slice(0,30)}</p>\n              <p class="product__category px-1" data-category="${t.category}">${i}</p>\n            </div>\n            <div class="product__price">\n              <p class="product__price-new">$${t.price}</p>\n              ${t.sale?`<p class="product__price-old">$${(t.price/(1-parseFloat(t.sale)/100)).toFixed(2)}</p>`:'<p class="product__price-old"></p>'}\n            </div>\n            <div class="product__rating">\n              ${[...Array(5)].map(((e,a)=>`<i class="product__rating-star ${a<t.rating?"fa-solid":"fa-regular"} fa-star"></i>`)).join("")}\n              <p class="product__rating-count">(${t.ratingCount})</p>\n            </div>\n            <div class="col-md-12">\n            <button class="btn btn-dark w-100 cartBTn" ${"Admin"===d?.role||parseInt(t?.createdBy)===d?.userId?"disabled":""} data-id="${t.id}"><i class="fa-solid fa-cart-plus px-2"></i> Add To Cart</button>\n            </div>\n          </div>\n        </div>\n      `,c.querySelector(".cartBTn").addEventListener("click",(()=>e(t)));const s=c.querySelector(".fa-heart");s.addEventListener("click",(()=>a(t.id.toString(),s))),o.appendChild(c)}));const i=document.querySelectorAll('input[type="checkbox"]');document.querySelectorAll("#product-container .col-md-4");i.forEach((e=>{e.addEventListener("change",(()=>n()))}))})).catch((e=>{document.getElementById("product-container").textContent="Failed to load products.",console.error("Error loading products:",e)})),t("product__title",".col-md-4"),document.querySelectorAll('.filter-options input[type="checkbox"]').forEach((e=>{e.addEventListener("change",n)})),document.getElementById("priceRange").addEventListener("input",(function(){document.getElementById("minPrice").value=this.value,n()})),document.getElementById("minPrice").addEventListener("input",(function(){document.getElementById("priceRange").value=this.value,n()})),document.getElementById("maxPrice").addEventListener("input",n);