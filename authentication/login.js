import{showToast as e,validateHashedPassword as t}from"../assets/js/utils.js";localStorage.getItem("token")&&(location.href="../index.html"),document.addEventListener("DOMContentLoaded",(()=>{const o=document.querySelector("form");o&&o.addEventListener("submit",(s=>{s.preventDefault();const r=JSON.parse(localStorage.getItem("users"))||[],a=o.email.value,l=o.password.value,n=r.find((e=>e.email===a));if(n&&t(l,n.password)){const t=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|*-`~!@#$%^&*()_{}[]|:;'<>,.";let t="";for(let o=0;o<64;o++)t+=e[Math.floor(Math.random()*e.length)];return t}();localStorage.setItem("token",t),n.token=t;const o=r.map((e=>e.email===n.email?{...e,token:t}:e));localStorage.setItem("users",JSON.stringify(o)),e("success","Login successful!"),setTimeout((()=>{open("/customer/home/home.html","_self")}),1500)}else e("error","please check your email or password.")}))}));